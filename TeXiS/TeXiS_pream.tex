%---------------------------------------------------------------------
%
%                        TeXiS_pream.tex
%
%---------------------------------------------------------------------
%
% TeXiS_pream.tex
% Copyright 2009 Marco Antonio Gomez-Martin, Pedro Pablo Gomez-Martin
%
% This file belongs to TeXiS, a LaTeX template for writting
% Thesis and other documents. The complete last TeXiS package can
% be obtained from http://gaia.fdi.ucm.es/projects/texis/
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
% 
% The Current Maintainers of this work are Marco Antonio Gomez-Martin
% and Pedro Pablo Gomez-Martin
%
%---------------------------------------------------------------------
%
% Contiene la parte inicial del documento, antes del
% \begin{document}. Carga los paquetes que se utilizarán.
%
%---------------------------------------------------------------------

% El paquete verbatim  es utilizado por uno de  los comandos definidos
% en TeXiS.  Aunque  el propio estilo indica que  necesita ese paquete
% con \RequirePackage, lo  hacemos "explícito" incluyéndolo aquí antes
% de incluir nuestro paquete.  Es necesario únicamente para el comando
% "example",  específico del  manual y  que con  toda seguridad  no se
% necesitará en  ningún otro tipo  de documento (Tesis, etc.),  por lo
% que si por alguna razón  la inclusión de este paquete interfiere con
% otros y se desea no tener que incluirlo, se puede cambiar TeXiS.sty,
% y eliminar el comando example.
\usepackage{verbatim}

% shortvrb supuestamente define algunas macros cómodas como carácteres
% de escape.  Por ejemplo, para poner  un < normalmente  hay que hacer
% una  ecuación:   $<$.  Este   paquete  define  algunas   macros  más
% intuitivas, en este caso bastaría  con \< De igual forma, para poner
% algo en  verbatim, la versión  larga es \texttt{blabla},  la versión
% corta es  \verb+blabla+ (el +  puede sustituirse por  cualquier otra
% cosa,  como un  |  ), y  con  este paquete  basta  con |blabla|  (es
% equivalente a \verb|blabla|).  Pero vamos... a mí no me funciona :-/
\usepackage{shortvrb}

% Modifica la codificación de  entrada para LaTeX. Básicamente permite
% escribir cosas con acentos (á) y  él solo lo sustituye por \'a. Para
% eso, se especifica  en el primer parámetro la  página de códigos que
% estamos utilizando (latin1  significa ISO Latin 1, o  sea ISO 8859-1
% supongo). Para cada página de códigos (en nuestro caso latin1) tiene
% un fichero de definiciones (.def)  en el que mapea cada carácter por
% encima del 128 a una orden LaTeX.
%
% Otra posible opción sería indicar utf8 (o utf8x) en lugar de latin1,
% que podría  resultar útil para  aquellos que prefieran  escribir sus
% fuentes  en  UTF-8 (como  tiende  a  ocurrir  actualmente de  manera
% predeterminada  en  Ubuntu). No  obstante,  una  búsqueda rápida  en
% google parece indicar  que el soporte para fuentes  TeX con UTF-8 no
% está demasiado  bien soportado y  podría dar algunos  problemas.  En
% TeXiS, además, seguro que generará conflictos, dado que si se indica
% aquí utf8  se asumirá que  *todo* usa UTF-8, incluídos  los ficheros
% del propio  TeXiS que en realidad  están con ISO  8859-1. Por tanto,
% usa  utf8  *bajo tu  propia  responsabilidad*.  TeXiS, desde  luego,
% recomienda el uso de ISO 8859-1.
\usepackage[utf8]{inputenc}

% Incluimos el  estilo de bibliografía natbib, para  poder citarlas de
% forma más compleja.  Por ejemplo,  \citep{ref} para que nos lo saque
% entre  paréntesis, \citet{ref}  normal  (si lo  referenciamos en  un
% texto), \citeyear{ref} para la  fecha del artículo, libro, etcétera,
% \citeauthor{ref} para los autores... Hay un montón de posibilidades.
% Puedes ver información en http://merkel.zoneo.net/Latex/natbib.php
%
% Es importante incluirlo ANTES de  babel. Si primero se añade babel y
% luego natbib,  cuando se tienen apellidos  "compuestos" (por ejemplo
% "Du  Boulay" natbib  añade  un  ~ de  separación  para convertir  al
% espacio  en un espacio  no separable  en dos  líneas, pero  al tener
% activado  babel  el ~  aparece  en lugar  de  salir  el espacio.  En
% cualquier  caso,  sigue  existiendo  un potencial  problema.  Natbib
% abrevia los  nombres poniendo únicamente las  iniciales (por ejemplo
% para  el nombre  compuesto Francisco  Nunes Ferreira  pone Ferreira,
% F. N.). El  problema es que también pone la ~  para separar, de modo
% que sale Ferreira F.Ñ. El problema está en que Babel automáticamente
% da significado  a ~n y lo  sustituye sin que le  digamos nada... hay
% más  información en  el comentario  de babel  y  en TeXiS_bib.tex
% http://chico.rediris.es/cgi-bin/wa?A2=ind0601&L=es-tex&D=0&P=1989
\usepackage[round]{natbib}

% Activa el  uso de  español. Babel es  un paquete bastante  gordo que
% afecta a  otros paquetes de  LaTeX que antes tenían  cableadas cosas
% para el inglés... por ejemplo, hace  que la 'Ñ' vaya después de la N
% en el orden alfabético, y cosas varias sobre español.
% En algún sitio leí que "activeacute" nos permite poner á en lugar de
% tener que escribir  \'a ... aunque eso en teoría  lo hace el paquete
% inputenc :-m
\usepackage[english,activeacute,spanish]{babel}

% El paquete url sirve para poder  poner direcciones Web y no morir en
% el intento,  sobre todo  en la bibliografía.   Es útil porque  si la
% dirección  no entra  en una  línea,  la divide  de forma  coherente.
% Además en  la bibliografía también  cambia el formato de  la fuente.
% Se utiliza poniendo la  dirección con \url{http://...}  También vale
% para direcciones de correo, etc.
% No conviene  quitarlo, porque con  casi toda seguridad, al  menos la
% bibliografía utilizará el comando.
\usepackage{url}

% Estilo del título de los capítulos
% Debe ir antes de hyperref
\usepackage[Lenny]{fncychap}

% Declaramos el comando \chapterquote para poder meter citas al comienzo de los capítulos
\DeclareRobustCommand{\chapterquote}[2]{%
	\begin{flushright}%
		%\vspace{-1cm}%
		\parbox{11cm}{\raggedleft\emph{``#1''}\\--- #2}%
		%\vspace{1cm}%
	\end{flushright}%
}

% Queremos pedir que se  creen enlaces en
% las  referencias  a figuras,  capítulos  y  bibliografía para  poder
% "navegar" al visualizar el PDF. También queremos que esos enlaces NO
% aparezcan rodeados de un marco que queda horrible.
%
% La opción "pdfpagelabels"  sirve para que en el  cuadrito del número
% de página del Adobe Acrobat  salga el número de "página lógico", por
% ejemplo  "v (5  de  180)"  (con número  romano  porque al  principio
% empieza a numerarse así).
\RequirePackage[pdfborder=0,hidelinks,hyperindex,pdfpagelabels]{hyperref}
\def\pdfBorderAttrs{/Border [0 0 0] } % Ningún borde en los enlaces
\hypersetup{colorlinks=false}

% El  paquete  glossaries  te  permite  generar listas  de  acrónimos  y
% glosarios.
\ifx\generatoc\undefined
  \usepackage[acronyms]{glossaries}
\else
  \usepackage[acronyms,toc]{glossaries}
\fi
\makeglossaries

% Para pedir que se genere  la información para el índice de palabras.
% Para  no  ralentizar la  compilación,  sólo  se  genera cuando  está
% definido el símbolo correspondiente.
\ifx\generaindice\undefined
\else
\makeindex
\fi

% Para poder utilizar el entorno multicol, útil en los sitios donde se
% quieren poner dos figuras una al lado de la otra.
\usepackage{multicol}

%
% Para  poder poner  "subfiguras". El  paquete permite  incluir varias
% figuras dentro  de un entorno  flotante (típicamente una  figura), y
% puede  etiquetar  cada  una  con  una letra,  y  asociar  diferentes
% descripciones a cada una.
%
% La idea  es crear  un entorno figura  tradicional, pero no  poner en
% ella  directamente  el  \includegraphics  (o  cualquier  otra  cosa,
% vamos), sino subdividir ese entorno  figura en varias partes. A cada
% una  de   ellas  se  le   da  una  etiqueta  diferente   para  poder
% referenciarlas, una descripción, etcétera.  Un ejemplo:
%
% \begin{figure}[t]
%   \centering
%   %
%   \subfloat[<ParaElIndice1>][<Caption1>]{ 
%      % Contenido para este "subelemento" (podrá ser una
%      % figura, una tabla, o cualquier otra cosa).
%      \includegraphics[width=5cm]{ficheroSinExtension}
%      \label{fig:etiqueta1}
%   }
%   \subfloat[<ParaElIndice2>][<Caption2>]{
%      % Contenido para este "subelemento" (podrá ser una
%      % figura, una tabla, o cualquier otra cosa).
%      \includegraphics[width=5cm]{ficheroSinExtension}
%      \label{fig:etiqueta2}
%   }
%  \caption{Descripción global para la figura}
%  \label{Etiqueta para toda la figura}
% \end{figure}
%
% El sistema  automáticamente decide cuando poner  la siguiente figura
% al lado, o  en otra linea. Es  posible forzar a que se  ponga en una
% linea nueva si se deja una linea en blanco en el .tex. Esto tiene la
% repercusión  de que  no deberías  dejar lineas  en blanco  en ningún
% momento dentro  del entorno flotante,  para evitar que se  "salte de
% linea"  en las  figuras.  Si quieres  por  legilibidad dejar  alguna
% linea, pon un comentario vacio.
%
% La separación  entre dos figuras/tablas  que se colocan en  la misma
% fila puede ser demasiado pequeña. Para seprarlas un poco más, puedes
% poner \qquad entre el cierre llaves de un \subfloat y el siguiente:
%
% [...]
%    \subfloat[..][..]{ ... }
%    \qquad
%    \subfloat[..][..]{ ... }
% [...]
%
% Por otro lado,  el \subfloat tiene dos "parámetros",  que se colocan
% entre   corchetes    justo   después.   En    realidad   ambos   son
% opcionales. Podríamos poner directamente:
%
% \subfloat{ <comandos para el subelemento> }
%
% pero en ese caso no se etiquetará con una letra.
%
% El texto que se pone entre los primeros corchetes se utiliza para el
% índice de figuras. En teoría, se mostrará en dicho índice primero la
% descripción global de la figura,  y luego la de cada subelemento. Si
% no  quieres que  ocurra,  deja  en blanco  el  contenido del  primer
% corchete. En la  práctica... yo he puesto una cadena  y no ha salido
% en el índice.
% El  segundo  corchete  recibe   el  texto  con  la  descripción  del
% subelemento,   es  decir  lo   que  aparecerá   junto  a   la  letra
% identificativa.  Si lo  dejas vacío  (pero poniendo  los corchetes),
% saldrá la letra, sin texto.  Si ni siquieras pones los corchetes, no
% saldrá tampoco la letra.
%
% Para referenciar  uno de los subelementos  basta con \ref{etiqueta},
% siendo  la   etiqueta  una  definida  mediante   \label  DENTRO  del
% \subfloat. La  forma de salir  será, por ejemplo, 2.3a  Si prefieres
% que salga  2.3 (a) (o quieres poner  "en la imagen (a)  de la figura
% 2.3...")  puedes  utilizar  \subref{etiquitaDeSubelemento}.  \subref
% escribirá el (a).  Combinándolo con la etiqueta global  de la figura
% (del  entorno flotante contenedor,  vamos) que  mostrará el  2.3 del
% ejemplo, puedes hacer cosas como la anterior con facilidad.
%
% Se pueden hacer muchas más pijadas, pero esto debería ser suficiente
% la mayor parte de las veces. Mira el manual oficial para más
% información (ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/subfig/subfig.pdf)
%
% Por cierto,  este paquete es la  evolución de subfigure,  pero no es
% compatible con él (por eso decidieron cambiarle el nombre).
\usepackage{subfig}

% El  paquete anterior  tiene un  problema  cuando se  utiliza en  los
% subfloat entornos verbatim (eso incluye a los lstlistings), debido a
% que  no  se  pueden  anidar  entornos verbatim  (bueno,  esa  es  la
% explicación que  he encontrado,  aunque no tenía  ni idea de  que se
% estuvieran anidando entornos verbatim :-) ).

% Para  arreglarlo, en la  documentación de  subfig dan  una solución,
% creando un  nuevo entorno,  SubFloat, que está  en una caja  LaTeX o
% algo  así, y que  consigue poder  meterlos. El  entorno se  define a
% continuación  (cortar  y  pegar  de  la  documentación  del  paquete
% subfig).
%
% Los dos parámetros que teníamos  antes para el \subfloat (caption, y
% caption para el índice) ahora se pasan de forma distinta:
%
% \begin{SubFloat}[texto indice]{Texto figura\label{<etiqueta>}
%    <contenido>
% \end{SubFloat}
%
% Es decir, hay que poner la etiqueta directamente en el parámetro del
% entorno.
%
% Para que el SubFloat funcione,  hay que hacer algo más, no obstante,
% ya que el entorno verbatim  (y lstlisting) NO definen en su creación
% lo que ocupan, y por lo tanto el \subfloat no es capaz de determinar
% cómo colocar las  subfiguras, ya que no conoce  su tamaño. Para eso,
% el entorno verbatim (o lstlisting)  hay que enmarcarlo dentro de una
% minipage en la que sí definimos (a mano) el tamaño. Un ejemplo puede
% ser:
%
% \begin{SubFloat}{\label{fig:ejercicios1a3:2}Ejercicio 2}%
% \begin{minipage}{0.4\linewidth}%
% \begin{lstlisting}[frame=tb]
% public void f(int b) {
%     int a;
%     a = 3 + b;
% }
% \end{lstlisting}%
% \end{minipage}
% \end{SubFloat}
%
% De esta  forma, se  hace que  el código en  el lstlisting  ocupe dos
% quintas  partes del ancho  de la  página.  Se  podría pensar  que es
% posible  utilizar  el  "parámetro"  linewidth  del  lstlisting,  que
% permite     también     indicar      el     ancho     del     código
% (\begin{lstlisting}[frame=tb,linediwth=0.4\linewidth]; sin embargo,
% eso  no es  posible ya  que ese  ancho es  utilizado por  el entorno
% lstlisting para  dibujar el marco  y, si tiene activado  el "romper"
% las líneas  automáticamente, para romperlas; si todas  las líneas de
% código  son más  cortas que  ese  espacio, el  espacio efectivo  del
% código será el ancho de la línea más ancha.
%
% Otra desagradable sorpresa surge  con los subfloat: existe un margen
% a los  lados del área reservada  a la subfigura, para  que no queden
% todas  pegadas.   Esto  está  bien,  porque así  no  tienes  tú  que
% encargarte de  definir el espacio; simplemente  decides cuánto ocupa
% de ancho cada  subfigura, y él se encarga de  colocarlo todo. Lo que
% ocurre es que parece no tener  en cuenta que, cuando a la derecha de
% un subfloat NO hay otro (porque es el último de la "línea"), _sigue_
% poniendo  el espacio  en blanco  para  separar con  el siguiente  (e
% inexistente) subfloat, lo  que hace que, en caso  de estar centrando
% los elementos, no quede perfectamente centrado :(

\makeatletter
\newbox\sf@box
\newenvironment{SubFloat}[2][]%
{\def\sf@one{#1}%
\def\sf@two{#2}%
\setbox\sf@box\hbox
\bgroup}%
{ \egroup
\ifx\@empty\sf@two\@empty\relax
\def\sf@two{\@empty}
\fi
\ifx\@empty\sf@one\@empty\relax
\subfloat[\sf@two]{\box\sf@box}%
\else
\subfloat[\sf@one][\sf@two]{\box\sf@box}%
\fi}
\makeatother

% Para poder  incluir código  fuente resaltado fácilmente.   El tamaño
% básico de la letra, pequeño.
\usepackage{listings}
\usepackage{xcolor}
\definecolor{commentgreen}{RGB}{2,112,10}
\definecolor{eminence}{RGB}{108,48,130}
\definecolor{weborange}{RGB}{255,165,0}
\definecolor{frenchplum}{RGB}{129,20,83}
\lstdefinelanguage{elixir}{
  morekeywords={case,catch,def,do,else,false,%
      use,alias,receive,timeout,defmacro,defp,%
      for,if,import,defmodule,defprotocol,%
      nil,defmacrop,defoverridable,defimpl,%
      super,fn,raise,true,try,end,with,%
      unless},
  otherkeywords={<-,->, |>, \%\{, \}, \{, \}, \, (, )},
  sensitive=true,
  morecomment=[l]{\#},
  morecomment=[n]{/*}{*/},
  morecomment=[s][\color{purple}]{:}{\ },
  morestring=[s][\color{orange}]"",
  commentstyle=\color{commentgreen},
  keywordstyle=\color{eminence},
  stringstyle=\color{red},
  basicstyle=\ttfamily,
  breaklines,
  showstringspaces=false,
  frame=tb
}

\lstset{numbers=left,xleftmargin=2em,frame=single,framexleftmargin=0em,numberstyle=\footnotesize\ttfamily}
\lstset{
    literate={~} {$\sim$}{1}
}

% Para poder utilizar el entorno tabularx, que sirve para hacer tablas
% con  párrafos, sin tener  que indicar  el ancho  de cada  columna de
% párrafo particular.
\usepackage{tabularx}

% Definimos  los  nombres para  las  tablas  y  el índice  de  tablas,
% sobreescribiendo los de babel, que los llama 'cuadros'.
\addto\captionsspanish{%
  \def\tablename{Tabla}%
  \def\contentsname{Índice}%
  \def\listfigurename{Índice de figuras}%
  \def\listtablename{Índice de tablas}%
  \def\chaptername{Cap\'itulo}%
}

% Definimos los nombres en inglés para que ponga figures y tables
% con minúscula
\addto\captionsenglish{%
	\def\listfigurename{List of figures}%
	\def\listtablename{List of tables}
}

% Supuestamente,  codificación   que  tiene  'nativas'   las  palabras
% acentuadas,  para poder  tener guionado  de palabras  con acentos...
% aunque no estoy yo demasiado seguro...
\usepackage[T1]{fontenc}

% Paquete para poder utilizar figuras EPS
\usepackage{epsfig}
%\usepackage[dvips]{graphicx}
%http://www.cidse.itcr.ac.cr/revistamate/HERRAmInternet/Latex/wmlatexrevista/node19.html

% Hacemos que los  párrafos se separen con algo más  de espacio que lo
% habitual.
%\usepackage{parskip}
\setlength{\parskip}{0.2ex}

% El paquete  psboxit permite poner  una imagen Post Script  dentro de
% una  caja de  TeX. La  imagen se  parametriza con  la posición  y el
% tamaño de la caja TeX.

%\usepackage{psboxit}

% Permite hacer cálculos sencillos dentro  de un documento de LaTeX Lo
% necesitamos en  la portada, para  poder ajustar los márgenes  con un
% poco de independencia  del tamaño de la página.  Consulta el fichero
% portada.tex para más información.
\usepackage{calc}

% Define el entorno  longtable que sirve para crear  tablas que ocupan
% más de una página.

%\usepackage{longtable}

% Cuando en una tabla tenemos lineas dobles de separación entre filas
% y columnas, LaTeX las pinta de manera que dé la sensación de que
% cada celda es un rectángulo:
%          | |
%  [celda] | | [celda]
%          | |
% ---------+ +---------
%                       <- hueco entre lineas
% ---------+ +---------
%          | |
%  [celda] | | [celda]
%          | |
%
% Si queremos que las líneas se corten:
%          | |
%  [celda] | | [celda]
%          | |
% ---------+-+---------
%          | |          <- hueco entre lineas
% ---------+-+---------
%          | |
%  [celda] | | [celda]
%          | |
%
% podemos utilizar el paquete hhline, que permite concretar en gran
% medida cómo queremos que queden los cruces
% (http://www.cs.wright.edu/~jslater/hhline.pdf)
%
% Otro uso interesante de hhline es como sustitutivo de \cline. \cline
% (nativo de LaTeX) permite poner lineas de separación entre filas que
% no englobe  a todas las  columnas. El problema  es que \cline  no se
% lleva bien con celdas con  fondo de color, porque queda _debajo_ del
% relleno y no se ve. \hhline sin embargo queda por encima, por lo que
% puede utilizarse para pintar lineas sencillas sin preocuparnos de la
% interacción  con las líneas  horizontales (quizá  también sencillas)
% pero aprovechar  que sí van a  verse.  En concreto, en  una tabla de
% cuatro columnas  \cline{1-3} es  similar a \hhline{----~}  (el guión
% indica  que  queremos  línea para  esa  columna,  y  el ~  que  no).
% \usepackage{hhline}

% Cambiamos el tamaño de las páginas para tener un poco más de espacio para escribir
\usepackage{geometry}
% \geometry{a4paper}
% \geometry{twosideshift=0pt}
\geometry{top=3cm,bottom=3cm,left=3cm,right=3cm}

%
% Paquete para  poder ampliar las  opciones de las tablas,  para poder
% tener párrafos  dentro de una celda  y que nos los  ajuste el propio
% LaTeX.
%
%\usepackage{tabulary}
% Otras opciones anteriores
%\usepackage{tabularx}  % Este está incluído por arriba
%\usepackage{array}

%\usepackage{slashbox}
% Para poder poner líneas diagonales en una tabla:
%
% \ b|  
%  \ |  ...
% a \|
% ---+----------
%    |
%    |
%
% En la casilla a dividir, \backslashbox{a}{b} & ...
% Vamos... no queda muy bien... en algún sitio vi que para mejorar un
% poco el aspecto se podía incluír pict2e también, aunque en cualquier
% caso el resultado podía seguir siendo discutible.

%
% Paquete para poder poner celdas de colores en una tabla
%
%\usepackage{colortbl}
%\usepackage{color}

% Paquete  que permite  cambiar  el formato  en  el que  se ponen  los
% títulos   de   capítulos,  secciones,   etc.    También  define   el
% comando \chaptertitlename, que  equivale a \chaptername ("Capítulo")
% cuando se está  dentro de un capítulo o  a \apendixname ("Apéndice")
% cuando se  está en un apéndice.  Eso se utiliza en  la definición de
% las cabeceras.
\usepackage{titlesec}

% Cambio del título de los capítulos (sacado de
% http://aristarco.dnsalias.org/book/export/html/13)

% \newcommand{\bigrule}{\titlerule[0.5mm]}

% \titleformat{\chapter}[display] % cambiamos el formato de los capítulos
% {\bfseries\Huge} % por defecto se usarán caracteres de tamaño \Huge en negrita
% {% contenido de la etiqueta
%  \titlerule % línea horizontal
%  \filleft % texto alineado a la derecha
%  \Large\chaptertitlename\ % "Capítulo" o "Apéndice" en tamaño \Large en lugar de \Huge
%  \Large\thechapter} % número de capítulo en tamaño \Large
% {0mm} % espacio mínimo entre etiqueta y cuerpo
% {\filleft} % texto del cuerpo alineado a la derecha
% [\vspace{0.5mm} \bigrule \vspace{1cm}] % después del cuerpo, dejar espacio vertical y trazar línea horizontal gruesa

\usepackage{csquotes}
\usepackage[final]{pdfpages}

\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{bussproofs}
\usepackage{fancyvrb}
